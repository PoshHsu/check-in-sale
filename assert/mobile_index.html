<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>
        </title>
        <link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
        <style>
            /* App custom styles */
        </style>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js">
        </script>
        <script src="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile-1.1.1.min.js">
        </script>
    </head>
    <body>
   <div id="fb-root"></div>
   <script>
   window.fbAsyncInit = function() {
        FB.init({
         appId  : "280399495394196",
         status : true, // check login status
         cookie : true, // enable cookies to allow the server to  access the session
         xfbml  : true, // parse XFBML
         channelUrl :'http://carpo.terrence-tang.com/channel.html', // channel.html file
         oauth  : true // enable OAuth 2.0
        });
        // Additional initialization code here
    };

    // Load the SDK Asynchronously
    (function(d){
         var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
         if (d.getElementById(id)) {return;}
             js = d.createElement('script'); js.id = id; js.async = true;
             //js.src = "//connect.facebook.net/en_US/all.js";
             js.src = "//connect.facebook.net/zh_TW/all.js";
             ref.parentNode.insertBefore(js, ref);
     }(document));
</script>

        <!-- Home -->
        <div data-role="page" id="page1">
            <div data-theme="b" data-role="header">
                <h5>
                    Carpo
                </h5>
            </div>
            <div data-role="content">
                <h2><span id="place"></span></h2>
                <div data-role="fieldcontain">
                    <fieldset data-role="controlgroup">
                        <label for="textinput1">
                            Message
                        </label>
                        <input name="" id="message" placeholder="" value="" type="text" />
                    </fieldset>
                </div>
                <a id="btn-checkin" data-role="button" data-theme="b" href="#page1">
                    Chenk-In
                </a>
                <a id="btn-friends" data-role="button" data-theme="b" href="#page1">
                    Friends
                </a>
            </div>
        </div>
    </body>
    <script src="../js/all.js"></script>
    <script src="../js/FBPlugs.js"></script>
        <script>
            var place = null;
            $("document").ready(function(){
                var pid = location.pathname.substr(8);
                queryQRCode(pid, function(res){
                  place = res;
                  $("#place").html(place.name)
                })

            });
            $("btn-checkin").click(function(){
               var message = $("#message").html();
               FBPlugs.checkin(place.pid,
                               place.lat,
                               place.long,
                               message,function(){alert("ok");})
            })
        </script>

</html>
